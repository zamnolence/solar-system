{% extends 'base.html' %}

{% block head %}
<title>Profile | Solar System Quiz</title>

{% endblock %}

{% block body %}

<!-- User general info -->
<div class="container">
<table class="table table-hover">
    <tr valign="top">
        <!-- Autogenerated avatar -->
        <td><img src="{{ user.avatar(128) }}"></td>
        <td>
            <h1>User: {{ user.username }}</h1>
            {% if user.about_me %}<p>{{ user.about_me }}</p>{% endif %}
            {% if user.last_seen %}<p>Last seen on: {{ user.last_seen.strftime('%B %d, %Y - %H:%M:%S') }}</p>{% endif %}
            {% if user == current_user %}
            <p><a href="{{ url_for('edit_profile') }}">Edit your profile</a></p>
            {% endif %}
        </td>
    </tr>
</table>
</div>

<!-- Posts -->
<div class="container">
  {% for post in posts %}
  {% include '_post.html' %}
  {% endfor %}
  {% if prev_url %}
  <a href="{{ prev_url }}">Newer posts</a>
  {% endif %}
  {% if next_url %}
  <a href="{{ next_url }}">Older posts</a>
  {% endif %}
</div>

<!-- History -->
<div class="container">
    <h2>Total Score: {{ score }}</h2>
    <h2>History</h2>
    <table style="width:100%;">
        <thead>
            <tr>
                <th>Module</th>
                <th>Score</th>
                <th>Time</th>
            </tr>
        </thead>
        <tbody>
        {% for score in scoreSorted %}
        {%  if loop.index <= 5  %}   <!-- Show top 5 attempts -->
            <tr>
                <td>{{ score.questionset_parent.name }}</td>
                <td>{{ score.score }}</td>
                <td>{{ score.time_taken }}</td>
            </tr>
        {% endif %}
        {% endfor %}
        </tbody>
    </table>
</div>

{% endblock %}